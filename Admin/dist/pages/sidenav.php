<!--
<aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
       
        <div class="sidebar-brand">
        
          <a href="./index.html" class="brand-link">
            
            <img
              src="../../dist/assets/img/AdminLTELogo.png"
              alt="AdminLTE Logo"
              class="brand-image opacity-75 shadow"
            />
           
            <span class="brand-text fw-light">AdminLTE 4</span>
           
          </a>
          
        </div>
        
        <div class="sidebar-wrapper">
          <nav class="mt-2">
            
            <ul
              class="nav sidebar-menu flex-column"
              data-lte-toggle="treeview"
              role="menu"
              data-accordion="false"
            >
              <li class="nav-item menu-open">
                <a href="#" class="nav-link active">
                  <i class="nav-icon bi bi-speedometer"></i>
                  <p>
                    Dashboard
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./index.html" class="nav-link active">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Dashboard v1</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./index2.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Dashboard v2</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./index3.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Dashboard v3</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="./generate/theme.html" class="nav-link">
                  <i class="nav-icon bi bi-palette"></i>
                  <p>Theme Generate</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-box-seam-fill"></i>
                  <p>
                    Widgets
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./widgets/small-box.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Small Box</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./widgets/info-box.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>info Box</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./widgets/cards.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Cards</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-clipboard-fill"></i>
                  <p>
                    Layout Options
                    <span class="nav-badge badge text-bg-secondary me-3">6</span>
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./layout/unfixed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Default Sidebar</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/fixed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Fixed Sidebar</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/layout-custom-area.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Layout <small>+ Custom Area </small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/sidebar-mini.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/collapsed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini <small>+ Collapsed</small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/logo-switch.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini <small>+ Logo Switch</small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/layout-rtl.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Layout RTL</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-tree-fill"></i>
                  <p>
                    UI Elements
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./UI/general.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>General</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./UI/icons.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Icons</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./UI/timeline.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Timeline</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-pencil-square"></i>
                  <p>
                    Forms
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./forms/general.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>General Elements</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-table"></i>
                  <p>
                    Tables
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./tables/simple.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Simple Tables</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-header">EXAMPLES</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-box-arrow-in-right"></i>
                  <p>
                    Auth
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-box-arrow-in-right"></i>
                      <p>
                        Version 1
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="./examples/login.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Login</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="./examples/register.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Register</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-box-arrow-in-right"></i>
                      <p>
                        Version 2
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="./examples/login-v2.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Login</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="./examples/register-v2.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Register</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="./examples/lockscreen.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Lockscreen</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-header">DOCUMENTATIONS</li>
              <li class="nav-item">
                <a href="./docs/introduction.html" class="nav-link">
                  <i class="nav-icon bi bi-download"></i>
                  <p>Installation</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/layout.html" class="nav-link">
                  <i class="nav-icon bi bi-grip-horizontal"></i>
                  <p>Layout</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/color-mode.html" class="nav-link">
                  <i class="nav-icon bi bi-star-half"></i>
                  <p>Color Mode</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-ui-checks-grid"></i>
                  <p>
                    Components
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./docs/components/main-header.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Main Header</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./docs/components/main-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Main Sidebar</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-filetype-js"></i>
                  <p>
                    Javascript
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./docs/javascript/treeview.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Treeview</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="./docs/browser-support.html" class="nav-link">
                  <i class="nav-icon bi bi-browser-edge"></i>
                  <p>Browser Support</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/how-to-contribute.html" class="nav-link">
                  <i class="nav-icon bi bi-hand-thumbs-up-fill"></i>
                  <p>How To Contribute</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/faq.html" class="nav-link">
                  <i class="nav-icon bi bi-question-circle-fill"></i>
                  <p>FAQ</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/license.html" class="nav-link">
                  <i class="nav-icon bi bi-patch-check-fill"></i>
                  <p>License</p>
                </a>
              </li>
              <li class="nav-header">MULTI LEVEL EXAMPLE</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>Level 1</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>
                    Level 1
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Level 2</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>
                        Level 2
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Level 2</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>Level 1</p>
                </a>
              </li>
              <li class="nav-header">LABELS</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-danger"></i>
                  <p class="text">Important</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-warning"></i>
                  <p>Warning</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-info"></i>
                  <p>Informational</p>
                </a>
              </li>
            </ul>
            
          </nav>
        </div>
        
      </aside>

-->








        <?php

if (!isset($_SESSION['role'])) {
    header("Location: ../../../index.php");
    exit();
}

// Get current page name and parent folder
$current_page = basename($_SERVER['PHP_SELF']);
$current_dir = basename(dirname($_SERVER['PHP_SELF']));

// Function to check if menu item is active
function isActive($page_name) {
    global $current_page;
    return ($current_page === $page_name) ? 'active' : '';
}

// Function to check if parent menu should be open
function isMenuOpen($pages) {
    global $current_page;
    foreach ($pages as $page) {
        if ($current_page === $page) {
            return 'menu-open';
        }
    }
    return '';
}

// Function to check if menu item should be active (including parent menus)
function isMenuActive($pages) {
    global $current_page;
    foreach ($pages as $page) {
        if ($current_page === $page) {
            return 'active';
        }
    }
    return '';
}

// Define page groups for menu sections
$dashboard_pages = ['index.php'];
$user_management_pages = ['total_users.php', 'user_roles.php', 'total_researchers.php'];
$research_pages = ['total_papers.php', 'upload_paper.php'];
$analytics_pages = ['generate_report.php'];
$directory_pages = ['view_papers.php'];
$profile_pages = ['edit_profile.php'];
$search_pages = ['search_with_us.php'];

?>

<!--begin::Sidebar-->
<aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
        <!--begin::Sidebar Brand-->
        <div class="sidebar-brand">
          <!--begin::Brand Link-->
          <a href="index.php" class="brand-link">
            <!--begin::Brand Image-->
            <img
              src="../../../asbab/images/logo/5.png"
              alt="Research Hub Logo"
              class="brand-image opacity-75 shadow"
            />
            <!--end::Brand Image-->
            <!--begin::Brand Text-->
            <span class="brand-text fw-light">Research Hub (<?php echo ucfirst($_SESSION['role']); ?>)</span>
            <!--end::Brand Text-->
          </a>
          <!--end::Brand Link-->
        </div>
        <!--end::Sidebar Brand-->
       <!--begin::Sidebar Wrapper-->
       <div class="sidebar-wrapper">
          <nav class="mt-2">
            <!--begin::Sidebar Menu-->
            <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
              <?php if ($_SESSION['role'] == 'admin' || $_SESSION['role'] == 'researcher' || $_SESSION['role'] == 'user'): ?>
              <!-- Dashboard - All Users -->
              <li class="nav-item <?php echo isMenuOpen($dashboard_pages); ?>">
                <a href="index.php" class="nav-link <?php echo isActive('index.php'); ?>">
                  <i class="nav-icon bi bi-speedometer"></i>
                  <p>Dashboard</p>
                </a>
              </li>

              <!-- Search With Us - All Users -->
              <li class="nav-item <?php echo isMenuOpen($search_pages); ?>">
                <a href="search_with_us.php" class="nav-link <?php echo isActive('search_with_us.php'); ?>">
                  <i class="nav-icon bi bi-search-heart"></i>
                  <p>Intelligent Search</p>
                </a>
              </li>
              <?php endif; ?>

              <?php if ($_SESSION['role'] == 'admin'): ?>
              <!-- Admin Only Section -->
              <li class="nav-item <?php echo isMenuOpen($user_management_pages); ?>">
                <a href="#" class="nav-link <?php echo isMenuActive($user_management_pages); ?>">
                  <i class="nav-icon bi bi-people-fill"></i>
                  <p>
                    User Management
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="total_users.php" class="nav-link <?php echo isActive('total_users.php'); ?>">
                      <i class="nav-icon bi bi-person-lines-fill"></i>
                      <p>Manage Users</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="role_manage.php" class="nav-link <?php echo isActive('user_roles.php'); ?>">
                      <i class="nav-icon bi bi-shield-check"></i>
                      <p>Role Management</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="total_researchers.php" class="nav-link <?php echo isActive('total_researchers.php'); ?>">
                      <i class="nav-icon bi bi-mortarboard-fill"></i>
                      <p>Manage Researchers</p>
                    </a>
                  </li>
                </ul>
              </li>
              <?php endif; ?>

              <?php if ($_SESSION['role'] == 'admin' || $_SESSION['role'] == 'researcher'): ?>
              <!-- Research Management - Admin & Researcher -->
              <li class="nav-item <?php echo isMenuOpen($research_pages); ?>">
                <a href="#" class="nav-link <?php echo isMenuActive($research_pages); ?>">
                  <i class="nav-icon bi bi-file-earmark-text"></i>
                  <p>
                    Research Management
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="total_papers.php" class="nav-link <?php echo isActive('total_papers.php'); ?>">
                      <i class="nav-icon bi bi-cloud-upload"></i>
                      <p>Research Papers</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="upload_paper.php" class="nav-link <?php echo isActive('upload_paper.php'); ?>">
                      <i class="nav-icon bi bi-file-earmark-plus"></i>
                      <p>Submit Research</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="view_papers.php" class="nav-link">
                      <i class="nav-icon bi bi-search"></i>
                      <p>Resource Discovery</p>
                    </a>
                  </li>
                </ul>
              </li>
              <?php endif; ?>

              <?php if ($_SESSION['role'] == 'admin' || $_SESSION['role'] == 'researcher'): ?>
              <!-- Collaboration - Admin & Researcher -->
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-chat-dots"></i>
                  <p>
                    Collaboration
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="manage_chat_access.php" class="nav-link">
                      <i class="nav-icon bi bi-people"></i>
                      <p>Research Teams</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="research_chat.php" class="nav-link">
                      <i class="nav-icon bi bi-chat-square-text"></i>
                      <p>Discussion Forum</p>
                    </a>
                  </li>
                </ul>
              </li>
              <?php endif; ?>

              <?php if ($_SESSION['role'] == 'admin'): ?>
              <!-- Analytics - Admin Only -->
              <li class="nav-item <?php echo isMenuOpen($analytics_pages); ?>">
                <a href="#" class="nav-link <?php echo isMenuActive($analytics_pages); ?>">
                  <i class="nav-icon bi bi-graph-up"></i>
                  <p>
                    Analytics
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-bar-chart"></i>
                      <p>Research Metrics</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-graph-up-arrow"></i>
                      <p>User Analytics</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="generate_report.php" class="nav-link <?php echo isActive('generate_report.php'); ?>">
                      <i class="nav-icon bi bi-file-earmark-text"></i>
                      <p>Generate Report</p>
                    </a>
                  </li>
                </ul>
              </li>
              <?php endif; ?>

              <!-- Common Features - All Users -->
              <li class="nav-item <?php echo isMenuOpen($directory_pages); ?>">
                <a href="#" class="nav-link <?php echo isMenuActive($directory_pages); ?>">
                  <i class="nav-icon bi bi-search"></i>
                  <p>
                    Research Directory
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="view_papers.php" class="nav-link <?php echo isActive('view_papers.php'); ?>">
                      <i class="nav-icon bi bi-journal-text"></i>
                      <p>Browse Research</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="search_with_us.php" class="nav-link">
                      <i class="nav-icon bi bi-search"></i>
                      <p>Advanced Search</p>
                    </a>
                  </li>
                </ul>
              </li>

              <li class="nav-item <?php echo isMenuOpen($profile_pages); ?>">
                <a href="edit_profile.php" class="nav-link <?php echo isActive('edit_profile.php'); ?>">
                  <i class="nav-icon bi bi-person-circle"></i>
                  <p>Profile Settings</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="support.php" class="nav-link">
                  <i class="nav-icon bi bi-question-circle"></i>
                  <p>Help & Support</p>
                </a>
              </li>

              <li class="nav-item">
                <a href="logout.php" class="nav-link">
                  <i class="nav-icon bi bi-box-arrow-right"></i>
                  <p>Logout</p>
                </a>
              </li>
            </ul>
            <!--end::Sidebar Menu-->
          </nav>
        </div>
        <!--end::Sidebar Wrapper-->
      </aside>
      <!--end::Sidebar-->